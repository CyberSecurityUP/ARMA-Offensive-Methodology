# üõ° **Exemplo Completo - Pentest Adversarial A.R.M.A.**

## üéØ **Cen√°rio:**  
**Cliente:** Banco Digital (Fintech)  
**Escopo:** WebApp, APIs, Mobile App e Cloud (AWS)  
**Objetivo:** Simular advers√°rio que visa extors√£o via vazamento de dados financeiros  
**Compliance:** PCI DSS, LGPD, DORA

---

## ‚úÖ **1. Context Discovery (Mapeamento + Superf√≠cie + Amea√ßas)**
### üîç Levantamento:
| Ativo | Descri√ß√£o | OWASP/CWE Risco |
|------|----------|-----------------|
| Web Portal | Cliente banking | A01 Broken Access, CWE-79 (XSS) |
| API /transfer | Transa√ß√µes financeiras | OWASP API #1 - Broken Object Level Authorization |
| Mobile App | React Native App | A06 Vulnerable Components |
| S3 Bucket | Armazenamento | CWE-200 - Information Exposure |

**Advers√°rio Simulado:** Grupo LAPSUS$ ‚Üí Motiva√ß√£o: vazamento / extors√£o financeira

---

## ‚úÖ **2. Adversarial Emulation & Pentest Planning**
**T√©cnicas mistas:** MITRE ATT&CK, OWASP, CWE
| Vetor | MITRE | OWASP/CWE | Objetivo |
|------|-------|----------|---------|
| Credenciais vazadas | T1078 Valid Accounts | CWE-798 Hardcoded Credentials | Acesso inicial |
| SQL Injection | T1190 Exploit Public-Facing App | CWE-89 | Pivotagem p/ Admin |
| Explora√ß√£o API | T1104 Multi-Hop Proxy | OWASP API #1 | Vazar dados financeiros |
| Exfiltra√ß√£o | T1041 Exfiltration Over C2 | CWE-200 | Vazar base de dados |

---

## ‚úÖ **3. Offensive Iterative Loops - Execu√ß√£o Real com Pivotagens**
| Dia | A√ß√£o | T√©cnica | Resultado |
|----|------|--------|----------|
| 1 | Recon | Subdomain enumeration | API /transfer descoberta |
| 2 | SQLi | CWE-89 | Admin Access WebApp |
| 3 | API Abuse | Broken Auth (API#1) | Consulta contas sem permiss√£o |
| 4 | S3 Leak | CWE-200 | Bucket exposto com backup de clientes |
| 5 | Exfiltra√ß√£o | T1041 | Download 500GB dados banc√°rios |

---

## ‚úÖ **4. Risk Chain Mapping**
```
SQLi /login ‚Üí Admin ‚Üí Abuse API /transfer ‚Üí Dump DB ‚Üí Exfiltra√ß√£o S3
```
**Pivotagens:** 3 n√≠veis (Web ‚Üí API ‚Üí Cloud)

**Impacto:** R$ 15 milh√µes em potencial + Quebra de LGPD + PCI DSS comprometido

---

## ‚úÖ **5. Business Impact + Compliance Mapping**
| Achado | CWE/OWASP | Impacto Neg√≥cio | Compliance |
|-------|----------|---------------|-----------|
| SQLi | CWE-89 | Controle Admin | PCI DSS Req. 6, LGPD Art. 46 |
| API Abuse | OWASP API #1 | Roubo de contas | LGPD, PCI DSS |
| S3 Bucket | CWE-200 | Vazamento 500GB | DORA - Continuidade |

---

## ‚úÖ **6. Score de Risco (C√°lculo Final)**
| Categoria | Pontua√ß√£o | Peso | Subtotal |
|----------|----------|-----|----------|
| T√©cnica | 9 | 1.5 | 13.5 |
| Profundidade | 10 | 2 | 20 |
| Impacto | 10 | 3 | 30 |
| Compliance | 9 | 2 | 18 |
| Detec√ß√£o | 10 (n√£o detectado) | 1.5 | 15 |
| **Subtotal Geral** | - | - | **96.5** |
| Cadeia / Pivotagem | x2 | | **193** |

**‚ö†Ô∏è Classifica√ß√£o: RISCO EXTREMO**

---

## ‚úÖ **7. Timeline de Ataque**
```
Dia 1 - Reconhecimento
Dia 2 - SQLi + Pivotagem Admin
Dia 3 - Abuso API
Dia 4 - Descoberta S3 P√∫blico
Dia 5 - Exfiltra√ß√£o dos Dados
```

---

## ‚úÖ **8. Recomenda√ß√£o Estrat√©gica**
- Remo√ß√£o de credenciais hardcoded
- Revalida√ß√£o de auth na API /transfer
- Refor√ßo de pol√≠ticas de S3 (Private by default)
- Testes cont√≠nuos baseados no A.R.M.A.
- Implementar Honeytokens e SIEM real-time

---

## ‚úÖ **9. Resultados entregues no Laudo (Visual / Tabelado / Gr√°fico)**
| M√©trica | Resultado |
|--------|----------|
| T√©cnicas MITRE usadas | 4 |
| OWASP / CWE explorados | 5 |
| Compliance quebrado | 3 (PCI, LGPD, DORA) |
| Valor financeiro impactado | R$ 15 milh√µes |
| Score Final | 193 (Risco Extremo) |

---

# ‚úÖ **Resumo Final:**
**O Pentest A.R.M.A. revelou:**  
‚úÖ Que a empresa estava cega para API Abuse (OWASP API#1)  
‚úÖ Exposi√ß√£o de dados grave em S3 (CWE-200)  
‚úÖ Ataque n√£o detectado, com movimenta√ß√£o lateral  
‚úÖ Risco financeiro **elevad√≠ssimo** + Multas regulat√≥rias

