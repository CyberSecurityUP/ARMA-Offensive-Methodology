# 🛡 **Pentest A.R.M.A. Aplicado ao DVWA - Exemplo Real de Execução Ofensiva**

## 🎯 **Contexto - O Cliente**
**Nome:** DVWA Bank Digital  
**Cenário:** WebApp público de Internet Banking  
**Compliance:** PCI DSS, LGPD  
**Objetivo do adversário:** 
- **Obter acesso total (Admin)**
- **Vazar dados de clientes**
- **Exfiltrar saldo das contas**

---

## ✅ **1. Context Discovery - Inteligência**
### 🔍 Levantamento Inicial:
| Ativo | OWASP / CWE | Superfície Exposta |
|------|-------------|--------------------|
| Login Page | OWASP A01 / CWE-798 | Possível brute-force |
| Command Injection | CWE-77 | Execução remota |
| SQLi Module | CWE-89 | Acesso DB |
| File Upload | CWE-434 | Upload malicioso |

🧠 **Mindset Adversarial:** *Se eu fosse um grupo APT ou um Lapsus$, onde eu entraria para pivotar?*

---

## ✅ **2. Adversarial Planning (antes de atacar)**
| **Objetivo Adversarial** | **Tática MITRE** | **Técnica OWASP/CWE** | **Plano** |
|-------------------------|------------------|-----------------------|----------|
| Explorar credenciais | T1078 Valid Accounts | Brute-Force Login | Descobrir user/pass fraco |
| Obter RCE | T1203 Exploit Public | CWE-77 | Explorar Command Injection |
| Dump DB | T1190 Exploit Public | CWE-89 SQLi | Roubo de senhas e saldos |
| Persistência | T1136 Create Account | CWE-434 Upload | Enviar WebShell |
| Exfiltrar dados | T1041 Exfiltration | CWE-200 Info Exposure | Vazar base de dados |

---

## ✅ **3. Offensive Iterative Loops - Execução real / mindset atacante**
🔄 **Execução NÃO linear - Teste, pivota, pensa o próximo passo**

### 🚀 **Loop 1 - Recon + Brute Force**
- Encontrado **admin / password**
- CWE-798 (default creds / weak password) ✔️
- Pivotagem liberada para área admin

🧠 *“Estou dentro. O que posso explorar com esse user?”*

---

### 🚀 **Loop 2 - SQL Injection (CWE-89)**
- Exploração da aba SQLi do DVWA
- Dump total da DB de clientes
- Dados financeiros e senhas capturados
- ✅ **Risco direto PCI DSS e LGPD**

---

### 🚀 **Loop 3 - Command Injection / RCE**
- Ganha shell remoto no servidor
- Movimentação lateral possível
- 🧠 *“Posso fazer persistência agora?”*

---

### 🚀 **Loop 4 - Upload Vulnerability (CWE-434)**
- Upload de WebShell maliciosa
- Persistência garantida
- Controle total do servidor web

---

## ✅ **4. Risk Chain Mapping (Pivotagens Claras)**
```
Brute Force → SQLi Dump → Command Injection (RCE) → Upload Shell → Controle Total
```

🎯 **Pivôs:** 4 saltos - Web → DB → OS → Persistência

---

## ✅ **5. Business Impact & Compliance Mapping**
| Vetor | CWE / OWASP | Impacto | Compliance Violado |
|------|------------|--------|--------------------|
| Brute Force | CWE-798 / OWASP A01 | Acesso Admin | PCI DSS 8.1 |
| SQLi | CWE-89 / OWASP A03 | Roubo de DB clientes | PCI DSS 6.5.1 / LGPD Art.46 |
| RCE | CWE-77 | Execução remota | DORA - Continuidade |
| Upload Shell | CWE-434 | Persistência / Data Exfil | PCI DSS 6.5.9 |

---

## ✅ **6. Risk Score (quantitativo)**
| Categoria      | Score | Peso | Subtotal |
|----------------|------|------|---------|
| Técnica        | 9    | 1.5  | 13.5 |
| Profundidade   | 10   | 2    | 20 |
| Impacto        | 9    | 3    | 27 |
| Compliance     | 9    | 2    | 18 |
| Detecção       | 10   | 1.5  | 15 |
| **Total Base** | -    | -    | **93.5** |
| Cadeia / Pivot | x2   |      | **187 (Risco Extremo)** |

---

## ✅ **7. Pós Exploração - O que um atacante REAL faria?**
- **Criaria backdoor na aplicação**
- **Plantaria fake users**
- **Exploraria outras APIs ou conexões**
- **Tentaria ir até a cloud backend (Pivot futuro)**
- **Venderia o dump no mercado negro**

🧠 *Mindset sempre: “Como eu escalo ou monetizo esse acesso?”*

---

## ✅ **8. Recomendação Profissional (Não só 'corrija o XSS')**
- Implementar WAF e bloqueio de brute-force
- Sanitização FULL da SQLi
- Uso de autenticação forte e rotatividade de credenciais
- Segmentação da aplicação / cloud
- Testes A.R.M.A. recorrentes (não pontuais)
